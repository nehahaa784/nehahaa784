import numpy as np
from tensorflow.keras.preprocessing.text import Tokenizer
from tensorflow.keras.preprocessing.sequence import pad_sequences
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Embedding, LSTM, Dense
from tensorflow.keras.utils import to_categorical

# Training Data(basic demo)
train_texts = [
    "I love this", "This is amazing", "I feel great",   # Positive
    "It is okay", "This is average", "Not bad, not good",  # Neutral
    "I hate this", "This is terrible", "I feel bad"     # Negative
]
train_labels = [
    2, 2, 2,   # Positive â†’ class 2
    1, 1, 1,   # Neutral  â†’ class 1
    0, 0, 0    # Negative â†’ class 0
]

# Step 2: Preprocessing(tokenization,sequencing,padding)
tokenizer = Tokenizer(num_words=1000, oov_token="<OOV>")
tokenizer.fit_on_texts(train_texts)
sequences = tokenizer.texts_to_sequences(train_texts)
padded = pad_sequences(sequences, maxlen=10, padding="post")
#label correction(converts the simple numerical labels (0, 1, 2) into a format called one-hot encoding, which is what the model's final layer expects.)
train_labels = np.array(train_labels)
train_labels = to_categorical(train_labels, num_classes=3)

# Step 3: Build Neural Network (model is a linear stack of layers)
model = Sequential([
    Embedding(input_dim=1000, output_dim=16, input_length=10),
    LSTM(32),
    Dense(16, activation="relu"),
    Dense(3, activation="softmax")
])

model.compile(optimizer="adam", loss="categorical_crossentropy", metrics=["accuracy"])
model.fit(padded, train_labels, epochs=15, verbose=1)

# Step 4: Take User Input
sentiment_classes = ["Negative ðŸ˜£", "Neutral ðŸ˜¶", "Positive ðŸ˜„"]

while True:
    user_input = input("Enter a sentence (or 'quit' to stop): ")
    if user_input.lower() == "quit":
        break

    seq = tokenizer.texts_to_sequences([user_input])
    padded_seq = pad_sequences(seq, maxlen=10, padding="post")

    prediction = model.predict(padded_seq, verbose=0)[0]
    sentiment = sentiment_classes[np.argmax(prediction)]
    confidence = np.max(prediction)

    print(f"Sentiment: {sentiment} (confidence={confidence:.4f})")
